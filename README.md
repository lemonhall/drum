# 太鼓达人 (Taiko no Tatsujin) - Godot 4 版本

一个使用 Godot 4 制作的太鼓达人风格音乐节奏游戏。

## 🎵 游戏特色

- **音乐同步**: 使用70 BPM的太鼓音乐，音符生成与节拍完美同步
- **节拍模式**: 6种不同的节拍模式，从简单到复杂逐渐递进
- **双音符系统**: 红色音符(DON)和蓝色音符(KA)
- **精确判定**: 完美、良好、错过三种判定等级
- **连击系统**: 连续击中可获得额外分数
- **专业音效**: 分离的鼓声、反馈音效和背景音乐播放器

## 🎮 操作方法

- **Z 或 X 键**: 击打红色音符 (咚 - DON)
- **C 或 V 键**: 击打蓝色音符 (咔 - KA)
- **ESC 键**: 暂停/继续游戏

## 🎼 音乐系统

### 节拍同步 (70 BPM)
游戏使用70 BPM的太鼓音乐，每拍约0.857秒。音符生成严格按照节拍进行，确保音乐与游戏完美同步。

### 节拍模式
游戏包含6种预设的节拍模式：

1. **简单四拍**: `咚 - 咚 -` (适合新手)
2. **交替模式**: `咚 咔 咚 咔` (基础练习)
3. **重音模式**: `咚 咚 - 咔` (节奏感训练)
4. **简单模式**: `咚 - - -` (放松模式)
5. **连击模式**: `咚 咚 咚 -` (连击练习)
6. **混合模式**: `咔 - 咚 咚` (综合训练)

### 音频架构
- **🥁 DrumPlayer**: 专门播放鼓声音效 (don/ka)
- **🔔 FeedbackPlayer**: 播放反馈音效 (perfect/miss)
- **🎼 BGMPlayer**: 播放背景音乐，不受游戏音效影响

## 📁 项目结构

```
drum/
├── scenes/
│   ├── GameMain.tscn      # 主游戏场景
│   └── Note.tscn          # 音符场景
├── scripts/
│   ├── GameMain.gd        # 游戏主控制器
│   ├── Note.gd            # 音符类
│   ├── NoteSpawner.gd     # 节拍同步音符生成器
│   ├── DrumController.gd  # 太鼓控制器
│   └── AudioManager.gd    # 音频管理器
├── audio/
│   ├── taiko drum-70bpm.mp3  # 主背景音乐 (70 BPM)
│   ├── don_hit.wav           # 红色音符音效
│   ├── ka_hit.wav            # 蓝色音符音效
│   ├── miss.wav              # 错过音效
│   └── perfect.wav           # 完美击中音效
└── README.md
```

## 🎯 游戏机制

### 判定系统
- **完美 (Perfect)**: 距离击打区域 ≤ 50像素，准确度 100%
- **良好 (Good)**: 距离击打区域 ≤ 100像素，准确度 50-99%
- **错过 (Miss)**: 距离击打区域 > 100像素或未击打

### 分数计算
```
总分 = 基础分数(100) + 准确度奖励(0-50) + 连击奖励(连击数×10，最高500)
```

### 音符同步
- 音符从左侧(x=0)生成，以116.7像素/秒的速度移动
- 移动到击打区域(x=1000)需要约8.57秒
- 这确保了音符到达时间与70 BPM的节拍完美同步

## 🔧 音效设置

游戏支持自动加载音效文件。如果没有音效文件，会使用占位符音调：

- **DON音效**: 200Hz音调
- **KA音效**: 400Hz音调  
- **MISS音效**: 100Hz音调
- **PERFECT音效**: 600Hz音调

### 推荐音效来源
- [Freesound.org](https://freesound.org) - 免费音效库
- [Zapsplat](https://zapsplat.com) - 专业音效库
- [Adobe Audition](https://www.adobe.com/products/audition.html) - 音效制作工具

## 🚀 运行游戏

1. 确保安装了 Godot 4.x
2. 打开项目文件 `project.godot`
3. 按 F5 运行游戏
4. 享受太鼓达人的乐趣！

## 🎵 音乐制作

当前使用的70 BPM太鼓音乐适合新手学习。如果需要更换音乐：

1. 将新的音乐文件放入 `audio/` 文件夹
2. 在 `AudioManager.gd` 中更新 `bgm_file` 路径
3. 在 `NoteSpawner.gd` 中调整 `bpm` 值
4. 根据需要修改 `beat_patterns` 数组

## 🎮 未来计划

- [ ] 更多节拍模式和难度等级
- [ ] 可视化节拍指示器
- [ ] 成绩记录和排行榜
- [ ] 自定义音乐导入功能
- [ ] 多人对战模式

---

**享受太鼓达人的节奏快感！** 🥁🎵 